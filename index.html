<!DOCTYPE html><html lang="zh-TW"><head><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
     <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è²“è²“å°ˆå±¬è¿·ä½ å åœ</title>
     
    <link rel="icon" href="icons/icon-192x192.png" sizes="192x192" type="image/png">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <link rel="manifest" href="manifest.json">
    <!-- æ·»åŠ å¯æ„›çš„å­—é«” - ç¢ºä¿å­—é«”å®Œå…¨åŠ è¼‰ -->
    <link href="https://fonts.googleapis.com/css2?family=Hachi+Maru+Pop&family=Kosugi+Maru&family=Baloo+2:wght@600;700&display=swap" rel="stylesheet" crossorigin="anonymous" media="all">
    
    <!-- å°ˆç”¨æ–¼Chromeçš„PWAæ”¯æŒ -->
    <!-- é»˜èªfaviconï¼ˆä½¿ç”¨base64ç·¨ç¢¼çš„å°PNGåœ–æ¨™ï¼‰ -->
    <link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAEJQTFRFAFz/AV3/Al7/A1//BGD/BWH/Dl//D2D/EGD/SXz/Sn3/kK7/ka//z9f/0Nj/0dn/4uf/4+j/8vX/8/X/9fb//f3//v7/bIBJkQAAACZ0Uk5TAAECBQcNDxUfICQmJy0uNTo7PUBBTE5YXWNveYqTpqu1yM7c7fb95XPJAAAAt0lEQVR42q2TSQ6DMBAEG4JZbMj+/P8nUQAplsm4hLpstyVXOTbqbZYgtlnfk8iwi+QcuZAEsiF7PGCD7J2SJwxIguRNvkwEgkmU3JYkEUwSSw5sNB1MYqJkCaArmCTNDmw0XThJZpLlgXZy4Gvx7JLcPBtfEhBsKBIbPkFRtKBOFFf2q1ApIoCqaKPdLPr5dPFt4nnJtOFxzb7jdc1OwvOaXcnjP3DW4PTkd8cP8meAn+NTGADR/RXVyPYnZAAAAABJRU5ErkJggg==">
    
    <!-- Chrome/Androidå°ˆç”¨Web App Manifest (ç›´æ¥ä½¿ç”¨data URI) -->
    <link rel="manifest" href="data:application/manifest+json;base64,ewogICJuYW1lIjogIuiyswSEKzYWzi6LKzYWwgNpPrDosrs+NUw6L+U5Y23mn4/lj6MiLAogICJzaG9ydF9uYW1lIjogIuiyswSEKzYWwgOnj+WPoyIsCiAgImRlc2NyaXB0aW9uIjogIua0u+WJjeWfteW+l+S+huiysyEiLAogICJzdGFydF91cmwiOiAiLiIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgIm9yaWVudGF0aW9uIjogInBvcnRyYWl0IiwKICAiYmFja2dyb3VuZF9jb2xvciI6ICIjZmZmZmZmIiwKICAidGhlbWVfY29sb3IiOiAiIzVENUNERSIsCiAgImdjbV9zZW5kZXJfaWQiOiAiIiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiaHR0cHM6Ly9pLmltZ3VyLmNvbS91NFVkc0N5LmpwZWciLAogICAgICAic2l6ZXMiOiAiMTkyeDE5MiIsCiAgICAgICJ0eXBlIjogImltYWdlL2pwZWciLAogICAgICAicHVycG9zZSI6ICJhbnkgbWFza2FibGUiCiAgICB9LAogICAgewogICAgICAic3JjIjogImh0dHBzOi8vaS5pbWd1ci5jb20vdTRVZHNDeS5qcGVnIiwKICAgICAgInNpemVzIjogIjUxMng1MTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9qcGVnIiwKICAgICAgInB1cnBvc2UiOiAiYW55IG1hc2thYmxlIgogICAgfQogIF0KfQo=">
    
    <!-- Chrome Web Appç‰¹å®šå…ƒæ•¸æ“š -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="è²“è²“å åœ">
    
    <!-- ç‚ºChromeè¨­ç½®ä¸»é¡Œè‰² -->
    <meta name="theme-color" content="#5D5CDE">
    
    <!-- iOSç‰¹æœ‰æ¨™ç±¤ -->
    <link rel="apple-touch-icon" href="https://i.imgur.com/u4UdsCy.jpeg">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="è²“è²“å åœ">
    
    <!-- å…¼å®¹èˆŠç‰ˆæœ¬æµè¦½å™¨ -->
    <link rel="shortcut icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAEJQTFRFAFz/AV3/Al7/A1//BGD/BWH/Dl//D2D/EGD/SXz/Sn3/kK7/ka//z9f/0Nj/0dn/4uf/4+j/8vX/8/X/9fb//f3//v7/bIBJkQAAACZ0Uk5TAAECBQcNDxUfICQmJy0uNTo7PUBBTE5YXWNveYqTpqu1yM7c7fb95XPJAAAAt0lEQVR42q2TSQ6DMBAEG4JZbMj+/P8nUQAplsm4hLpstyVXOTbqbZYgtlnfk8iwi+QcuZAEsiF7PGCD7J2SJwxIguRNvkwEgkmU3JYkEUwSSw5sNB1MYqJkCaArmCTNDmw0XThJZpLlgXZy4Gvx7JLcPBtfEhBsKBIbPkFRtKBOFFf2q1ApIoCqaKPdLPr5dPFt4nnJtOFxzb7jdc1OwvOaXcnjP3DW4PTkd8cP8meAn+NTGADR/RXVyPYnZAAAAABJRU5ErkJggg==" type="image/png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        'primary-light': '#7a79e3'
                    }
                }
            }
        }
    </script>
    <style>
        :root {
            --app-scale: 1;
        }
        
        /* èƒŒæ™¯å›¾ç‰‡è®¾ç½® */
        body {
            background-image: url('https://i.imgur.com/Q5NDOF7.jpeg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
        }
        
        /* æ·»åŠ åŠé€æ˜è¦†ç›–å±‚ï¼Œä½¿å‰æ™¯å†…å®¹æ›´æ˜“è¯» */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.7);
            z-index: -1;
        }
        
        /* æ¨¡æ…‹çª—å£æ¨£å¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-container {
            background-color: white;
            padding: calc(1.5rem * var(--app-scale));
            border-radius: 12px;
            width: 90%;
            max-width: calc(500px * var(--app-scale));
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            transform: translateY(-20px);
            transition: transform 0.3s ease;
        }
        
        .modal-overlay.active .modal-container {
            transform: translateY(0);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: calc(1rem * var(--app-scale));
            border-bottom: 1px solid #eee;
            padding-bottom: calc(0.75rem * var(--app-scale));
        }
        
        .modal-title {
            font-size: calc(1.5rem * var(--app-scale));
            font-weight: bold;
            color: #333;
        }
        
        .modal-close {
            font-size: calc(1.5rem * var(--app-scale));
            background: none;
            border: none;
            cursor: pointer;
            color: #666;
        }
        
        .modal-close:hover {
            color: #333;
        }
        
        /* è¿”å›æŒ‰éˆ•æ¨£å¼ - æ”¾åœ¨å³é‚Š */
        .back-button {
            display: inline-flex;
            align-items: center;
            padding: calc(0.5rem * var(--app-scale)) calc(1rem * var(--app-scale));
            background-color: #f0f0f0;
            border: none;
            border-radius: 8px;
            font-size: calc(1rem * var(--app-scale));
            color: #333;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-top: calc(1rem * var(--app-scale));
            float: right; /* æ”¾åœ¨å³é‚Š */
        }
        
        .back-button:hover {
            background-color: #e0e0e0;
        }
        
        .back-button-icon {
            margin-right: calc(0.5rem * var(--app-scale));
        }
        
        /* éƒµç®±åˆ—è¡¨å’Œå…§å®¹å€åŸŸ */
        .mail-view, .mail-detail-view {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        
        .mail-view.hidden, .mail-detail-view.hidden {
            display: none;
            opacity: 0;
            transform: translateY(20px);
        }
        
        .mail-view, .mail-detail-view:not(.hidden) {
            opacity: 1;
            transform: translateY(0);
        }
        
        .mail-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .mail-item {
            padding: calc(0.75rem * var(--app-scale));
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            margin-bottom: calc(0.75rem * var(--app-scale));
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
        }
        
        .mail-item:hover {
            background-color: #f5f5f5;
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .mail-item.active {
            border-color: #90CAF9;
            background-color: #E3F2FD;
        }
        
        .mail-icon {
            margin-right: calc(0.75rem * var(--app-scale));
            font-size: calc(1.25rem * var(--app-scale));
            color: #FF6B6B;
        }
        
        .mail-title {
            font-weight: 500;
        }
        
        .mail-content {
            padding: calc(1.5rem * var(--app-scale));
            line-height: 1.6;
            background-color: #f9f9f9;
            border-radius: 8px;
            min-height: calc(150px * var(--app-scale));
            white-space: pre-line;
        }
        
        /* éƒµç®±è©³ç´°é é¢çš„æ¨™é¡Œ */
        .mail-detail-title {
            font-size: calc(1.25rem * var(--app-scale));
            font-weight: bold;
            margin-bottom: calc(1rem * var(--app-scale));
            color: #333;
            padding-bottom: calc(0.5rem * var(--app-scale));
            border-bottom: 1px solid #eee;
        }
        
        /* æ•´é«”å®¹å™¨è¨­ç½®ç‚ºè¦–å£é«˜åº¦ï¼Œé¿å…æ»¾å‹• */
        .app-container {
            min-height: 100vh;
            max-height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            box-sizing: border-box;
            padding: 1rem;
        }
        
        /* æ ¹æ“šä¸åŒå±å¹•é«˜åº¦è¨­ç½®ç¸®æ”¾æ¯”ä¾‹ - æ›´ç²¾ç´°çš„æ¢¯åº¦ */
        /* æ¡Œé¢ç‰ˆæ¡ç”¨æ›´å¤§å°ºå¯¸ */
        @media (min-width: 768px) and (min-height: 800px) {
            :root {
                --app-scale: 1.3;
            }
        }
        
        @media (min-width: 992px) and (min-height: 900px) {
            :root {
                --app-scale: 1.5;
            }
        }
        
        @media (min-width: 1200px) and (min-height: 900px) {
            :root {
                --app-scale: 1.7;
            }
        }
        
        /* å°å±å¹•ç¸®æ”¾æ¢¯åº¦ */
        @media (max-height: 800px) {
            :root {
                --app-scale: 0.95;
            }
        }
        
        @media (max-height: 700px) {
            :root {
                --app-scale: 0.85;
            }
        }
        
        @media (max-height: 600px) {
            :root {
                --app-scale: 0.75;
            }
        }
        
        @media (max-height: 500px) {
            :root {
                --app-scale: 0.65;
            }
        }
        
        @media (max-height: 400px) {
            :root {
                --app-scale: 0.55;
            }
        }
        
        /* æ¨™é¡Œç¸®æ”¾å’Œå¯æ„›å­—é«” - ç§»é™¤ç²—é«” */
        .app-title {
            font-size: calc(1.875rem * var(--app-scale));
            margin-bottom: calc(0.5rem * var(--app-scale));
            font-family: 'Baloo 2', cursive !important;
            font-weight: 400; /* ç§»é™¤ç²—é«” */
            letter-spacing: 0.03em;
            /* ç¢ºä¿å­—é«”åŠ è¼‰å‰æœ‰é©ç•¶çš„å‚™ç”¨é¸é … */
            font-display: swap;
        }
        
        /* å…±äº«æŒ‰é’®æ ·å¼ - ä¸ºéƒµç®±å’Œç­¾åˆ°æ¡†è®¾ç½®å…±åŒçš„æ ·å¼ */
        .button-common {
            position: absolute;
            left: calc(1rem * var(--app-scale));
            border-radius: 12px;
            padding: calc(0.8rem * var(--app-scale)) calc(1.2rem * var(--app-scale));
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            z-index: 50;
            display: flex;
            align-items: center;
            justify-content: center;
            width: calc(8.5rem * var(--app-scale)); /* å¢åŠ å®½åº¦ï¼Œé¿å…ä¸¤è¡Œæ˜¾ç¤º */
            white-space: nowrap; /* é˜²æ­¢æ–‡æœ¬æ¢è¡Œ */
            font-size: calc(1.1rem * var(--app-scale)); /* è°ƒæ•´å­—ä½“å¤§å°ä¸º1.1rem */
            font-weight: 500;
        }
        
        /* éƒµç®±ç®±æ¨£å¼ */
        .mailbox {
            top: calc(5rem * var(--app-scale)); /* å†æé«˜3remä½ç½®åˆ°5rem */
            background-color: #E3F2FD; /* æ·ºè—è‰²åº•è‰² */
            color: #333333;
            transition: all 0.3s ease;
            border: 2px solid #90CAF9;
            cursor: pointer;
        }
        
        .mailbox:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            background-color: #BBDEFB;
        }
        
        .mailbox-icon {
            margin-right: calc(0.6rem * var(--app-scale));
            font-size: calc(1.2rem * var(--app-scale));
        }
        
        /* ç°½åˆ°è¨ˆæ•¸å™¨æ¨£å¼ - èˆ‡éƒµç®±æ¡†ä¿æŒä¸€è‡´å¯¬åº¦ */
        .checkin-counter {
            top: calc(9rem * var(--app-scale)); /* å†æé«˜3remä½ç½®åˆ°9remï¼Œä¿æŒ4remé—´è· */
            background-color: #FFF8E1; /* æ·ºé»ƒè‰²åº•è‰² */
            color: #333333; /* æ”¹ç‚ºé»‘è‰² */
            transition: all 0.5s cubic-bezier(0.18, 0.89, 0.32, 1.28); /* æ›´æµæš¢çš„å‹•ç•« */
            border: 2px solid #FFE082;
            cursor: pointer; /* å¯ç‚¹å‡»çŠ¶æ€ */
        }
        
        /* å·²ç°½åˆ°æ¨£å¼ */
        .checkin-counter.checked {
            background-color: #E0E0E0; /* æ·ºç°è‰²èƒŒæ™¯ */
            color: #757575; /* ç°è‰²æ–‡å­— */
            border: 2px solid #BDBDBD;
            cursor: not-allowed; /* ä¸å¯é»æ“Šç‹€æ…‹ */
        }
        
        /* ç°½åˆ°å€’è¨ˆæ™‚æç¤º */
        .checkin-timer {
            position: absolute;
            top: calc(13rem * var(--app-scale)); /* ä½ç½®åœ¨ç°½åˆ°æŒ‰éˆ•ä¸‹æ–¹ */
            left: calc(1rem * var(--app-scale));
            font-size: calc(0.8rem * var(--app-scale));
            color: #757575;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .checkin-timer.show {
            opacity: 1;
        }
        
        .checkin-icon {
            margin-right: calc(0.6rem * var(--app-scale));
            font-size: calc(1.2rem * var(--app-scale));
        }
        
        /* ç°½åˆ°è¨ˆæ•¸å‹•ç•« - æ›´è±å¯Œçš„å‹•ç•«æ•ˆæœ */
        @keyframes counter-update {
            0% { transform: scale(1); }
            20% { transform: scale(1.4); }
            40% { transform: scale(0.9); }
            60% { transform: scale(1.2); }
            80% { transform: scale(0.95); }
            100% { transform: scale(1); }
        }
        
        /* ç°½åˆ°æˆåŠŸå¾Œçš„é–ƒçˆæ•ˆæœ */
        @keyframes checkin-success {
            0% { box-shadow: 0 0 5px rgba(255, 193, 7, 0.5); background-color: #FFF8E1; }
            50% { box-shadow: 0 0 20px rgba(255, 193, 7, 0.8); background-color: #FFE082; }
            100% { box-shadow: 0 0 5px rgba(255, 193, 7, 0.5); background-color: #FFF8E1; }
        }
        
        .counter-animation {
            animation: counter-update 0.7s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            color: #FF6B6B;
            font-weight: bold;
        }
        
        .checkin-success {
            animation: checkin-success 1.5s ease-in-out;
        }
        
        /* æ—¥æœŸå’Œå¤©æ•¸ç¸®æ”¾ */
        .date-display {
            font-size: calc(0.875rem * var(--app-scale));
            margin-top: calc(0.5rem * var(--app-scale));
        }
        
        .day-display {
            font-size: calc(1.25rem * var(--app-scale));
            margin-top: calc(0.25rem * var(--app-scale));
        }
        
        /* åœ–ç‰‡å®¹å™¨ç¸®æ”¾ - ä¼˜åŒ–å°å±å¹•æ˜¾ç¤º */
        .image-container {
            position: relative;
            width: calc(100% * var(--app-scale));
            max-width: calc(350px * var(--app-scale));
            min-width: 200px; /* è®¾ç½®æœ€å°å®½åº¦ï¼Œé˜²æ­¢è¿‡åº¦ç¼©å° */
            height: auto;
            aspect-ratio: 1.14 / 1; /* ç¶­æŒåŸå§‹çš„å¯¬é«˜æ¯”ä¾‹ */
            margin: calc(-2rem * var(--app-scale)) auto calc(30px * var(--app-scale)) auto; /* å¢åŠ è´Ÿmarginçš„å€¼ï¼Œæé«˜å›¾ç‰‡ä½ç½® */
            cursor: pointer;
            transition: transform 0.3s ease;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1; /* ç¢ºä¿åœ–ç‰‡åœ¨è¼ƒä½å±¤ç´š */
        }
        
        /* å°å±å¹•ç‰¹æ®Šå¤„ç† */
        @media (max-height: 600px) {
            .image-container {
                margin-top: -40px; /* åœ¨å°å±å¹•ä¸Šä½¿ç”¨å›ºå®šçš„è´Ÿmargin */
            }
        }
        
        /* éŸ¿æ‡‰å¼èª¿æ•´ - è®¾ç½®æœ€å°å®½åº¦ */
        @media (max-width: 640px) {
            .image-container {
                max-width: calc(280px * var(--app-scale));
                min-width: 200px;
            }
        }
        
        @media (max-width: 480px) {
            .image-container {
                max-width: calc(250px * var(--app-scale));
                min-width: 180px;
            }
        }
        
        /* æ–å‹•å‹•ç•«å®šç¾© */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-3px); }
            20%, 40%, 60%, 80% { transform: translateX(3px); }
        }
        
        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }
        
        /* ç§»é™¤hoveræ”¾å¤§æ•ˆæœ */
        .image-container:active {
            transform: scale(0.98);
        }
        
        .image-wrapper {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            /* ç§»é™¤è¾¹æ¡†æ•ˆæœ */
            padding: 0;
        }
        
        .main-image {
            width: 100%;
            height: 100%;
            object-fit: cover; /* æ”¹ç‚ºcoverä»¥å¯¦ç¾å‰ªè£æ•ˆæœ */
            object-position: center; /* åªé¡¯ç¤ºä¸­é–“éƒ¨åˆ† */
            position: absolute;
            transition: opacity 0.3s ease;
            clip-path: inset(20% 0 20% 0); /* å‰ªè£ä¸Šä¸‹å„20% */
        }
        
        .initial-image, .clicked-image, .final-image {
            opacity: 0;
        }
        
        .image-active {
            opacity: 1;
        }
        
        /* é»æ“Šè¨ˆæ•¸æç¤º - è°ƒæ•´ä¸å›¾ç‰‡çš„è·ç¦»ä¸º5rem */
        .click-progress {
            position: absolute;
            bottom: calc(-5rem * var(--app-scale)); /* ä¿®æ”¹ä¸º5remè·ç¦» */
            left: 0;
            right: 0;
            text-align: center;
            font-weight: bold;
            color: #5D5CDE;
            font-size: calc(18px * var(--app-scale)); /* ç¸®æ”¾å­—é«”å¤§å° */
            opacity: 0;
            transition: opacity 0.3s ease;
            font-family: 'Hachi Maru Pop', cursive; /* æ·»åŠ å¯æ„›å­—é«” */
        }
        
        .click-progress.show {
            opacity: 1;
        }
        
        /* çµæœå®¹å™¨ */
        .fortune-container {
            min-height: calc(80px * var(--app-scale));
            max-height: calc(150px * var(--app-scale));
            overflow-y: auto;
            border-radius: 12px;
            transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
            transform: translateY(10px);
            opacity: 0;
            padding: calc(0.85rem * var(--app-scale)) !important;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: calc(1rem * var(--app-scale));
        }
        
        .fortune-container.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        /* çµæœæ–‡å­— - æ¡Œé¢ç‰ˆç‰¹åˆ¥è™•ç† */
        .fortune-text {
            font-size: calc(1.3rem * var(--app-scale));
            line-height: calc(1.6 * var(--app-scale));
            font-weight: 500;
            color: #333;
            white-space: normal; /* ç¢ºä¿æ–‡å­—å¯ä»¥æ›è¡Œ */
            word-wrap: break-word; /* é•·å–®è©å¯ä»¥æ–·è¡Œ */
        }
        
        /* æ¡Œé¢ç‰ˆå­—é«”èª¿æ•´ */
        @media (min-width: 768px) {
            .fortune-text {
                font-size: calc(1rem * var(--app-scale));
                line-height: calc(1.3 * var(--app-scale));
            }
        }
        
        /* å€’è¨ˆæ™‚å®¹å™¨ */
        .countdown-container {
            margin-top: calc(0.75rem * var(--app-scale));
            padding-top: calc(0.75rem * var(--app-scale));
            font-size: calc(0.875rem * var(--app-scale));
        }
        
        /* æ¡Œé¢ç‰ˆèª¿æ•´å€’è¨ˆæ™‚é¡¯ç¤º */
        @media (min-width: 768px) {
            .countdown-container {
                font-size: calc(1rem * var(--app-scale));
            }
            
            #countdown-timer {
                font-size: calc(1.05rem * var(--app-scale));
            }
        }
        
        /* é è…³ */
        .app-footer {
            font-size: calc(0.75rem * var(--app-scale));
            margin-top: calc(0.25rem * var(--app-scale));
        }
        
        /* åŠ è¼‰å‹•ç•«å®¹å™¨ */
        .loading {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 30;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center bg-white text-gray-800">
    <div class="app-container w-full flex flex-col items-center justify-between">
        <!-- ä¿¡ä»¶ç®± - æ”¹åç‚ºéƒµç®± -->
        <div id="mailbox" class="mailbox button-common">
            <span class="mailbox-icon">â¤ï¸</span>
            éƒµç®±
        </div>
        
        <!-- ç°½åˆ°è¨ˆæ•¸å™¨ -->
        <div id="checkin-counter" class="checkin-counter button-common">
            <span class="checkin-icon">ğŸ¾</span>
            <span id="checkin-count">0</span> æ¬¡ç°½åˆ°
        </div>
        
        <!-- ç°½åˆ°å€’è¨ˆæ™‚æç¤º -->
        <div id="checkin-timer" class="checkin-timer">
            ä¸‹æ¬¡ç°½åˆ°: <span id="next-checkin-time">00:00:00</span>
        </div>
        
        <!-- éƒµç®±æ¨¡æ…‹çª—å£ -->
        <div id="mail-modal" class="modal-overlay">
            <div class="modal-container">
                <div class="modal-header">
                    <h2 class="modal-title">è²“è²“é€šè¨Š</h2>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <!-- éƒµç®±åˆ—è¡¨è¦–åœ– -->
                    <div id="mail-list-view" class="mail-view">
                        <ul class="mail-list">
                            <li class="mail-item" data-mail-id="mail-1">
                                <span class="mail-icon">â¤ï¸</span>
                                <span class="mail-title">è²“è²“ç”Ÿæ—¥</span>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- éƒµç®±å…§å®¹è¦–åœ– - ç§»å‹•è¿”å›æŒ‰éˆ•åˆ°å†…å®¹åï¼Œç§»é™¤æ ‡é¢˜ -->
                    <div id="mail-detail-view" class="mail-detail-view hidden">
                        <div id="mail-detail-content" class="mail-content"></div>
                        <button id="back-to-list" class="back-button">
                            <span class="back-button-icon">â†</span> è¿”å›
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- éš±è—çš„éƒµç®±å…§å®¹ -->
        <div id="mail-contents" style="display: none;">
            <div id="mail-1" class="mail-content-data">
è¦ªæ„›çš„è²“è²“ï¼š

èª’ï¼Œç¬¬äºŒæ¬¡è·Ÿè²“è²“éç”Ÿæ—¥äº†ï¼Œé›–ç„¶æˆ‘è¨˜æ€§ä¸å¥½ï¼Œä½†ä¸Šä¸€å¹´åœ¨è»Šè»Šè·Ÿè²“è²“éç”Ÿæ—¥çš„ç•«é¢ä»æ·±åˆ»ï¼ç•¶æ™‚è²“è²“èªªæ²’å¤ªæœŸå¾…éç”Ÿæ—¥ï¼Œæˆ‘ä¸€æ–¹é¢å¸Œæœ›è²“è²“æœŸå¾…ï¼ˆè­‰æ˜è²“è²“å¸Œæœ›å¾—åˆ°æˆ‘çš„å¿ƒæ„ï¼‰ï¼Œå¦ä¸€æ–¹é¢å®³æ€•è²“è²“æœŸå¾…ï¼ˆå› ç‚ºæˆ‘è¦ºå¾—æº–å‚™å¾—ä¸å¥½å—šï¼‰TAT

æœ€è¿‘å¾ˆç–²æ†Šï¼Œæ±è¥¿å¥½åƒåšä¸å®Œä¼¼çš„ï¼Œå¯èƒ½å› ç‚ºå¯¦éš›å·¥ä½œæ™‚é–“æ¯”ä¹‹å‰çŸ­äº†ï¼ˆæ²’ç•™åˆ°10é»ï¼ˆXï¼‰æ¯ç•¶åœ¨å­¸æ ¡å·¥ä½œè¨±ä¹…å¾Œæ‰æœ‰æ™‚é–“æ‰¾è²“è²“ï¼Œä¾¿æœƒè¦ºå¾—æ„§ç–šã€‚ç¾åœ¨ä¸åœ¨ä¸€å€‹åœ°æ–¹å·¥ä½œï¼Œè¦‹é¢çš„æ©Ÿæœƒå°‘äº†å¾ˆå¤šï¼Œç¸½è¦ºå¾—ä¸æ»¿è¶³ã€‚åŠ ä¸Šæ˜ŸæœŸå…­æ—¥ä¸æ˜¯æˆ‘å¿™å°±æ˜¯ä½ ç´¯ï¼Œæœ‰æ™‚æœƒæš¢æƒ³ï¼Œè¦æ˜¯å¹³æ—¥å›å®¶èƒ½çœ‹åˆ°è²“è²“å°±å¥½äº†wwwä¸åƒ…åƒ…æ˜¯æˆ‘ï¼Œè²“è²“ç¾åœ¨ä¹Ÿå·¥ä½œåˆ°å¾ˆæ™šï¼æ²’è³‡æ ¼èªªæˆ‘å–œæ­¡OTäº†ï¼æˆ‘æœƒåšè‘—å®¶å‹™ç­‰è²“è²“çš„ï¼ˆå’¦

é›–ç„¶è²“è²“å¸¸å¸¸ä¸çµ¦è¦ªè¦ªä¸çµ¦æ‘¸æ‘¸ï¼ˆè‚šè‚šï¼‰ï¼Œå¯æˆ‘ä¾ç„¶æ„›è‘—ä½ çš„å¹¼ç¨šä½ çš„å£ä¸å°å¿ƒã€‚è¢«ä½ æ¨é–‹çš„æ™‚å€™æˆ‘æœƒæé†’è‡ªå·±åˆ¥å¤ªé›£éï¼Œå› ç‚ºé€™æ˜¯ä½ çš„åå°„å‹•ä½œã€‚æƒ…äººç¯€çš„æ™‚å€™èªªä¹‹å¾Œé€ä¸åŒèŠ±èŠ±çµ¦è²“è²“ï¼Œåƒé–‹åœ–é‘‘ä¼¼çš„ã€‚å…¶å¯¦é€™æ¬¡æˆ‘æœ¬æ‰“ç®—åšé‡ç¹”ç«ç‘°èŠ±ï¼Œè²·äº†ææ–™åŒ…ï¼Œå•†å®¶è²ç¨±æœƒé™„ä¸Šä¿å§†ç´šæ•™å­¸ï¼Œç„¶è€Œæˆ‘é€£å½±ç‰‡é–‹é ­éƒ½çœ‹ä¸æ‡‚@.@å¥®æˆ°äº†ä¸€å°æ™‚ä»æ²’æ³•é–‹å§‹ï¼Œçµæœå…ˆæ“±ç½®ä¸€é‚Šäº†ã€‚é‚„å¥½å¯ä»¥åœ¨é€™è£¡æ·»ä¸ŠèƒŒæ™¯çš„å°é»ƒèŠ±ï¼Œå§‘ä¸”ä¹Ÿç®—èŠ±ï¼Ÿ

å‘€å‘€å‘€ï¼Œèªªäº†å¾ˆå¤šæ²’ç‡Ÿé¤Šçš„è©±ã€‚å…ˆèªªåˆ°é€™è£¡ï¼Œä¸å®šæœŸæ›´æ–°:P è²“è²“ç”Ÿæ—¥å¿«æ¨‚ï¼

18/3/2025
            </div>
        </div>
        
        <header class="w-full max-w-xl text-center">
            <h1 class="app-title font-bold text-primary">è²“è²“å°ˆå±¬è¿·ä½ å åœ</h1>
            <div id="current-datetime" class="date-display font-medium text-gray-700"></div>
            <div id="day-counter" class="day-display font-bold text-gray-700"></div>
        </header>

        <main class="flex-1 w-full max-w-xl flex flex-col items-center justify-center">
            <div class="w-full flex flex-col items-center">
                <div id="image-container" class="image-container">
                    <!-- åœ–ç‰‡åŒ…è£å™¨ -->
                    <div class="image-wrapper">
                        <img src="https://i.imgur.com/RdfIav1.png" alt="å¯æ„›çš„è²“" id="initial-image" class="main-image initial-image image-active">
                        <img src="https://i.imgur.com/Ff7QTIv.png" alt="å¯æ„›çš„è²“é»æ“Šæ•ˆæœ" id="clicked-image" class="main-image clicked-image">
                        <img src="https://i.imgur.com/dgyoDVN.jpeg" alt="å¯æ„›çš„è²“æœ€çµ‚åœ–" id="final-image" class="main-image final-image">
                    </div>
                    
                    <!-- åŠ è¼‰å‹•ç•« -->
                    <div id="loading" class="loading">
                        <div class="w-8 h-8 border-3 border-primary-light border-t-transparent rounded-full animate-spin"></div>
                    </div>
                    
                    <!-- é»æ“Šé€²åº¦æç¤º -->
                    <div id="click-progress" class="click-progress">å†é»æ“Š 5 æ¬¡</div>
                </div>

                <div class="fortune-container w-full bg-white rounded-lg shadow-md text-center" id="fortune-box">
                    <p class="fortune-text font-medium" id="fortune-text"></p>
                    <!-- å€’è¨ˆæ™‚å®¹å™¨ -->
                    <div id="countdown-container" class="countdown-container border-t border-gray-200 text-gray-600 hidden">
                        <p id="countdown-text">é‚„æœ‰ <span id="countdown-timer" class="font-bold text-primary">00:00:00</span> å¯é–‹å§‹ä¸‹ä¸€æ¬¡é æ¸¬</p>
                    </div>
                </div>
            </div>
        </main>

        <footer class="app-footer w-full max-w-xl text-center text-gray-500">
            <p>è¼•è§¸åœ–ç‰‡ï¼Œç²å¾—ä»Šæ—¥çš„ç‰¹åˆ¥é¼“å‹µå§ï¼</p>
        </footer>
    </div>
    
    <!-- å‹•æ…‹èª¿æ•´ç¸®æ”¾æ¯”ä¾‹çš„è…³æœ¬ -->
    <script>
        // å®Œå…¨é‡å¯«ç°¡å–®çš„ç¸®æ”¾æ©Ÿåˆ¶ï¼Œç¢ºä¿å›ºå®šçš„å¯é çµæœ
        function updateLayout() {
            const vh = window.innerHeight;
            const vw = window.innerWidth;
            const header = document.querySelector('header');
            const dayCounter = document.getElementById('day-counter');
            const imageContainer = document.getElementById('image-container');
            
            // ç¢ºä¿Day Xé¡¯ç¤ºåœ¨åœ–ç‰‡ä¹‹ä¸Š
            if (dayCounter && imageContainer) {
                dayCounter.style.position = 'relative';
                dayCounter.style.zIndex = '10'; // ç¢ºä¿Day Xåœ¨åœ–ç‰‡ä¹‹ä¸Š
            }
            
            // è¨­ç½®å›ºå®šçš„ç¸®æ”¾æ¯”ä¾‹ï¼Œä¸å†å‹•æ…‹è¨ˆç®—
            let scale = 1.0;
            
            // æ¡Œé¢è¨­å‚™ - å›ºå®šå¤§å°ºå¯¸
            if (vw >= 1024) {
                // å¤§å‹æ¡Œé¢
                scale = 1.4;
                
                // éå¸¸å¤§çš„å¯¬å±
                if (vw > 1400) {
                    scale = 1.5;
                }
            } 
            else if (vw >= 768) {
                // å¹³æ¿/å°å‹æ¡Œé¢
                scale = 1.2;
            }
            // æ‰‹æ©Ÿè¨­å‚™
            else {
                // æ ¹æ“šæ‰‹æ©Ÿé«˜åº¦è¨­ç½®åˆç†çš„ç¸®æ”¾
                scale = 1.0;
                if (vh < 700) scale = 0.9;
                if (vh < 600) scale = 0.8;
                if (vh < 500) scale = 0.7;
            }
            
            // æ‡‰ç”¨ç¸®æ”¾å€¼
            document.documentElement.style.setProperty('--app-scale', scale);
            
            console.log(`è¦–çª—å°ºå¯¸: ${vw}x${vh}px, ç¸®æ”¾æ¯”ä¾‹: ${scale}`);
        }
        
        // é é¢è¼‰å…¥å’Œèª¿æ•´å¤§å°æ™‚æ›´æ–°ä½ˆå±€
        window.addEventListener('load', updateLayout);
        window.addEventListener('resize', updateLayout);
        
        // ç«‹å³æ›´æ–°ä¸€æ¬¡ä½ˆå±€
        updateLayout();
    </script>

    <script>
        // ç°½åˆ°è¨ˆæ•¸å™¨ - ç®¡ç†ç´¯è¨ˆå åœæ¬¡æ•¸
        const CHECKIN_COUNTER_KEY = 'catFortuneCheckinCount';
        const LAST_CHECKIN_DATE_KEY = 'catFortuneLastCheckinDate';
        
        // å‰µå»ºå†…å­˜è®Šé‡å­˜å„²ç°½åˆ°æ•¸æ“š
        let checkinCount = 0;
        let lastCheckinTime = null; // ä¸Šæ¬¡ç­¾åˆ°æ—¶é—´
        let checkedInToday = false; // ä»Šå¤©æ˜¯å¦å·²ç­¾åˆ°
        
        // åŠ è¼‰ä¸¦é¡¯ç¤ºç´¯è¨ˆç°½åˆ°æ¬¡æ•¸ - ä½¿ç”¨å†…å­˜è®Šé‡
        function loadCheckinCount() {
            // æ›´æ–°UIé¡¯ç¤º
            document.getElementById('checkin-count').textContent = checkinCount;
            return checkinCount;
        }
        
        // æª¢æŸ¥ä»Šå¤©æ˜¯å¦å·²ç¶“ç°½åˆ°é
        function hasCheckedInToday() {
            return checkedInToday;
        }
        
        // è·å–ä¸‹æ¬¡å¯ç­¾åˆ°æ—¶é—´ï¼ˆæ—©ä¸Š7ç‚¹ï¼‰
        function getNextCheckinTime() {
            const now = new Date();
            // æ˜å¤©æ—©ä¸Š7é»
            const tomorrow = new Date(now);
            tomorrow.setDate(now.getDate() + 1);
            tomorrow.setHours(7, 0, 0, 0);
            
            // å¦‚æœç¾åœ¨æ™‚é–“é‚„æ²’åˆ°ä»Šå¤©æ—©ä¸Š7é»ï¼Œé‚£éº¼é‡ç½®æ™‚é–“æ˜¯ä»Šå¤©æ—©ä¸Š7é»
            if (now.getHours() < 7) {
                tomorrow.setDate(now.getDate());
            }
            
            return tomorrow.getTime() - now.getTime();
        }
        
        // æ›´æ–°ç°½åˆ°æŒ‰éˆ•ç‹€æ…‹
        function updateCheckinButtonState() {
            const checkinCounter = document.getElementById('checkin-counter');
            const checkinTimer = document.getElementById('checkin-timer');
            const nextCheckinTime = document.getElementById('next-checkin-time');
            
            if (hasCheckedInToday()) {
                // å·²ç°½åˆ°ç‹€æ…‹
                checkinCounter.classList.add('checked');
                checkinTimer.classList.add('show');
                
                // è®¡ç®—å¹¶æ˜¾ç¤ºä¸‹æ¬¡å¯ç­¾åˆ°æ—¶é—´
                const timeToNextCheckin = getNextCheckinTime();
                nextCheckinTime.textContent = formatCountdown(timeToNextCheckin);
            } else {
                // å¯ç°½åˆ°ç‹€æ…‹
                checkinCounter.classList.remove('checked');
                checkinTimer.classList.remove('show');
            }
        }
        
        // æ£€æŸ¥æ˜¯å¦å¯ä»¥é‡ç½®ç­¾åˆ°çŠ¶æ€
        function checkAndResetCheckinState() {
            if (!lastCheckinTime) return;
            
            const now = new Date();
            const lastDate = new Date(lastCheckinTime);
            
            // è·å–ä»Šå¤©7ç‚¹çš„æ—¶é—´
            const todayReset = new Date(now);
            todayReset.setHours(7, 0, 0, 0);
            
            // å¦‚æœç°åœ¨å·²ç»è¿‡äº†ä»Šå¤©7ç‚¹ï¼Œä¸”ä¸Šæ¬¡ç­¾åˆ°æ˜¯åœ¨ä»Šå¤©7ç‚¹ä¹‹å‰
            if (now >= todayReset && lastDate < todayReset) {
                checkedInToday = false;
                updateCheckinButtonState();
            }
        }
        
        // æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡æ˜¯å¦éœ€è¦é‡ç½®ç­¾åˆ°çŠ¶æ€
        setInterval(checkAndResetCheckinState, 60000);
        
        // å¢åŠ ç°½åˆ°è¨ˆæ•¸ä¸¦ä¿å­˜ - åŠ å¼·å‹•ç•«æ•ˆæœ
        function incrementCheckinCount() {
            // å¦‚æœä»Šå¤©å·²ç¶“ç°½åˆ°ï¼Œä¸å…è¨±å†æ¬¡ç°½åˆ°
            if (hasCheckedInToday()) {
                showAlreadyCheckedInMessage();
                return checkinCount;
            }
            
            // è®°å½•ç­¾åˆ°ä¿¡æ¯
            checkedInToday = true;
            lastCheckinTime = new Date().getTime();
            checkinCount += 1;
            
            // ä½¿ç”¨æ›´æ˜é¡¯çš„å‹•ç•«æ•ˆæœ
            const countElement = document.getElementById('checkin-count');
            const counter = document.getElementById('checkin-counter');
            
            // å…ˆç§»é™¤ä¹‹å‰çš„ä»»ä½•å‹•ç•«é¡
            countElement.classList.remove('counter-animation');
            counter.classList.remove('checkin-success');
            counter.classList.remove('animate-pulse');
            
            // è§¸ç™¼é‡æ’ä»¥ç¢ºä¿å‹•ç•«æ•ˆæœé‡æ–°æ‡‰ç”¨
            void counter.offsetWidth;
            
            // æ›´æ–°UIé¡¯ç¤º
            countElement.textContent = checkinCount;
            
            // æ·»åŠ æ›´å¤šå‹•ç•«é¡
            countElement.classList.add('counter-animation');
            counter.classList.add('checkin-success');
            
            // æ·»åŠ ç°½åˆ°æˆåŠŸæ–‡æœ¬æç¤º
            const successText = document.createElement('div');
            successText.textContent = 'ç°½åˆ°æˆåŠŸï¼';
            successText.style.position = 'absolute';
            successText.style.top = '-30px';
            successText.style.left = '0';
            successText.style.right = '0';
            successText.style.textAlign = 'center';
            successText.style.color = '#FF6B6B';
            successText.style.fontWeight = 'bold';
            successText.style.fontSize = `${1 * parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--app-scale'))}rem`;
            successText.style.opacity = '0';
            successText.style.transition = 'opacity 0.3s ease-in-out, transform 0.8s ease-out';
            successText.style.transform = 'translateY(0)';
            
            counter.appendChild(successText);
            
            // é¡¯ç¤ºæ–‡æœ¬æç¤ºä¸¦å‹•ç•«
            setTimeout(() => {
                successText.style.opacity = '1';
            }, 100);
            
            setTimeout(() => {
                successText.style.transform = 'translateY(-20px)';
            }, 200);
            
            // å‹•ç•«çµæŸå¾Œç§»é™¤é¡å’Œæç¤º
            setTimeout(() => {
                countElement.classList.remove('counter-animation');
                counter.classList.remove('checkin-success');
                successText.style.opacity = '0';
                
                setTimeout(() => {
                    successText.remove();
                    // æ›´æ–°ç­¾åˆ°æŒ‰é’®çŠ¶æ€
                    updateCheckinButtonState();
                }, 500);
            }, 2000);
            
            console.log('ç°½åˆ°æˆåŠŸï¼ç›®å‰ç´¯è¨ˆï¼š', checkinCount);
            
            return checkinCount;
        }
        
        // æ˜¾ç¤ºå·²ç»ç­¾åˆ°è¿‡çš„æç¤º
        function showAlreadyCheckedInMessage() {
            const counter = document.getElementById('checkin-counter');
            const alreadyCheckinText = document.createElement('div');
            alreadyCheckinText.textContent = 'ä»Šæ—¥å·²ç°½åˆ°ï¼';
            alreadyCheckinText.style.position = 'absolute';
            alreadyCheckinText.style.top = '-30px';
            alreadyCheckinText.style.left = '0';
            alreadyCheckinText.style.right = '0';
            alreadyCheckinText.style.textAlign = 'center';
            alreadyCheckinText.style.color = '#F44336';
            alreadyCheckinText.style.fontWeight = 'bold';
            alreadyCheckinText.style.fontSize = `${1 * parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--app-scale'))}rem`;
            alreadyCheckinText.style.opacity = '0';
            alreadyCheckinText.style.transition = 'opacity 0.3s ease-in-out';
            
            counter.appendChild(alreadyCheckinText);
            
            setTimeout(() => {
                alreadyCheckinText.style.opacity = '1';
            }, 100);
            
            setTimeout(() => {
                alreadyCheckinText.style.opacity = '0';
                setTimeout(() => {
                    alreadyCheckinText.remove();
                }, 500);
            }, 2000);
        }
        
        // æ›´æ–°ç­¾åˆ°å€’è®¡æ—¶
        function updateCheckinCountdown() {
            if (hasCheckedInToday()) {
                const nextCheckinTime = document.getElementById('next-checkin-time');
                const timeToNextCheckin = getNextCheckinTime();
                nextCheckinTime.textContent = formatCountdown(timeToNextCheckin);
                
                // å¦‚æœå·²åˆ°é‡ç½®æ—¶é—´ï¼Œé‡ç½®ç­¾åˆ°çŠ¶æ€
                if (timeToNextCheckin <= 0) {
                    checkedInToday = false;
                    updateCheckinButtonState();
                }
            }
        }
        
        // è¨ˆç®—å¾2024å¹´2æœˆ15æ—¥åˆ°ä»Šå¤©çš„å¤©æ•¸
        function calculateDays() {
            const startDate = new Date('2024-02-15');
            const today = new Date();
            
            // å°‡å…©å€‹æ—¥æœŸè¨­ç½®ç‚ºç•¶æ—¥çš„0æ™‚0åˆ†0ç§’ï¼Œä»¥ä¾¿è¨ˆç®—æº–ç¢ºçš„æ—¥æœŸå·®
            startDate.setHours(0, 0, 0, 0);
            today.setHours(0, 0, 0, 0);
            
            // è¨ˆç®—æ¯«ç§’å·®ç•°
            const diffTime = Math.abs(today - startDate);
            // è½‰æ›ç‚ºå¤©æ•¸
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            // æ›´æ–°é¡¯ç¤º
            document.getElementById('day-counter').textContent = `Day ${diffDays}`;
        }
        
        // æ›´æ–°æ—¥æœŸæ™‚é–“
        function updateDateTime() {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth() + 1;
            const day = now.getDate();
            
            // æ ¼å¼åŒ–å°æ™‚ç‚º12å°æ™‚åˆ¶
            let hours = now.getHours();
            const ampm = hours >= 12 ? 'pm' : 'am';
            hours = hours % 12;
            hours = hours ? hours : 12; // 0æ‡‰è©²é¡¯ç¤ºç‚º12
            
            // æ ¼å¼åŒ–åˆ†é˜
            const minutes = String(now.getMinutes()).padStart(2, '0');
            
            // ä¾ç…§æŒ‡å®šæ ¼å¼: 2025å¹´3æœˆ11æ—¥ 10:48pm
            const formattedDateTime = `${year}å¹´${month}æœˆ${day}æ—¥ ${hours}:${minutes}${ampm}`;
            
            document.getElementById('current-datetime').textContent = formattedDateTime;
            
            // åŒæ™‚æ›´æ–°å¤©æ•¸è¨ˆæ•¸
            calculateDays();
        }
        
        // åˆå§‹åŒ–æ—¥æœŸæ™‚é–“ä¸¦æ¯åˆ†é˜æ›´æ–°ä¸€æ¬¡
        updateDateTime();
        setInterval(updateDateTime, 60000);

        // è²“å’ªå åœçµæœåˆ—è¡¨
        const encouragements = [
            "åˆ¥æ“”å¿ƒï¼Œé­šä¹¾ç¸½æœƒæœ‰çš„ï¼",
            "çª—å¤–çš„é³¥é£›å¿«ï¼Œè€Œä½ å¦‚æ­¤å„ªé›…åœ°çœºæœ›ã€‚",
            "èˆ”èˆ”è‡ªå·±çš„çˆªå­ï¼Œç”Ÿæ´»ç¸½æœƒå†äº®æ™¶æ™¶èµ·ä¾†ï¼",
            "åˆ¥å®³æ€•é»‘å¤œï¼Œä½ æœ‰æœ€æ•éŠ³çš„çœ¼ç›å’Œæœ€æŸ”è»Ÿçš„å¿ƒã€‚",
            "å°±ç®—ä»Šå¤©ç¿»å€’äº†æ°´ç¢—ï¼Œæ˜å¤©ä¾ç„¶æœ‰æ¸…æ¶¼çš„æ°´ã€‚",
            "å³ä½¿ä¸–ç•Œå¾ˆå¤§ï¼Œä½ çš„å°çª©æ°¸é æ˜¯æœ€æº«æš–çš„åœ°æ–¹ã€‚",
            "å“ªæ€•ä»Šå¤©æ›¬ä¸åˆ°å¤ªé™½ï¼Œä½†å¤ªé™½ç¸½åœ¨ï¼",
            "èª’ï¼ä¸€èµ·å»åƒç”œå“å¥½ä¸å¥½ï¼",
            "ä½ çš„æ¯æ¬¡è¹­è¹­ï¼Œéƒ½æ˜¯åˆ¥äººæº«æš–çš„ç¦®ç‰©ã€‚",
            "æ¯ä¸€æ¬¡çš„è·³èºï¼Œéƒ½æ›´é è¿‘æ˜Ÿæ˜Ÿã€‚",
            "æˆ‘å–µæ•…æˆ‘åœ¨ã€‚",
            "å¦‚æœç…å…«çˆªé­šè…³è…³ï¼Œå°±æœƒå‚³å‡ºé¦™å‘³ã€‚",
            "åœ¨æ³¥å·´è£¡æ‰“æ»¾çš„é™¤äº†è±¬è±¬ï¼Œé‚„æœ‰è¿‘è±¬è€…è±¬çš„è²“è²“ã€‚",
            "æ²’æœ‰ä»€éº¼æ˜¯ä¸å¯èƒ½çš„ï¼Œé™¤äº†ä¸€å¤©ä¸åƒç½ç½ã€‚",
            "è²“è²“ä¸è·‘æ­¥ä¹Ÿè¨±æ˜¯å¥½çš„ã€‚è·‘å¤ªå¿«å°±è®Šè±¹è±¹äº†ã€‚",
            "èº«ç‚ºä¸€éš»å„ªç§€çš„è²“è²“æ‡‰è©²è¦æ‡‚å¾—æ”€å²©ã€‚èª’è²“è²“æœ‰èˆˆè¶£ä¸€èµ·å»ç©å—ï¼Ÿ",
            "è²“è²“è·Ÿå£«å¤šå•¤æ¢¨çš„å…±åŒé»å°±æ˜¯â€¦â€¦éƒ½æ˜¯æˆ‘æ„›çš„ï¼",
            "é–‰çœ¼åç§’å†çœçœ¼ï¼Œæœƒæœ‰å¥½é‹æ°£å“¦ã€‚",
            "å¥½æƒ³å’Œè²“è²“å»æ—…è¡Œ:3:3:3",
            "è·¯ä¸Šçš„è²“ä¸éƒ½æ˜¯è¿·è·¯äº†ï¼Œæœ‰äº›åªæ˜¯è‡ªç”±åœ°æ•£æ­¥ã€‚",
            "ä¸–ç•Œä¸Šæœ€è®“è²“èˆ’æœçš„äº‹ï¼Œå°±æ˜¯æ›¬å¤ªé™½èˆ‡è¢«æ„›ã€‚",
            "ä¸€éš»å–µçš„åƒ¹å€¼ï¼Œä¸åœ¨æ–¼ç‰ æŠ“äº†å¤šå°‘è€é¼ ï¼Œè€Œåœ¨æ–¼ç‰ å¦‚ä½•äº«å—ç”Ÿæ´»ã€‚",
            "åˆ¥å•è²“å’ªèƒ½ç‚ºä½ åšä»€éº¼ï¼Œå•å•ä½ èƒ½ç‚ºè²“å’ªåšä»€éº¼ã€‚",
            "è²“å’ªç”Ÿä¾†å°±æ˜¯è¦èººåœ¨é™½å…‰ä¸‹ï¼Œè€Œä¸æ˜¯å»è¿½é€æ¿€å…‰é»ã€‚",
            "æŠ“ä¸ä½çš„æ¯›ç·šçƒï¼Œç¸½æ˜¯æœ€æœ‰è¶£çš„ã€‚",
            "çµ¦è²“å’ªä¸€å€‹çª—å°ï¼Œç‰ èƒ½çœ‹é€æ•´å€‹å®‡å®™ã€‚",
            "åˆ¥äººçœ‹è¦‹è²“å’ªåœ¨ç¡è¦ºï¼Œä½†ç‰ çš„å¤¢è£¡æ˜¯å»£é—Šçš„è‰åŸã€‚",
            "æ²’æœ‰ä»€éº¼æ¯”è²“å’ªåœ¨é™½å…‰ä¸‹æ‰“æ»¾æ›´æ¥è¿‘å¤©å ‚ã€‚",
            "æŠŠè²“å’ªå’Œå¤šå£«ç¶åœ¨ä¸€èµ·å°±è®Šæˆæ°¸å‹•æ©Ÿï¼ï¼ˆå’¦ï¼Ÿï¼‰",
            "è²“å’ªç„¡éœ€è§£é‡‹ï¼Œå› ç‚ºç‰ çš„å­˜åœ¨å°±æ˜¯æœ€å¥½çš„ç†ç”±ã€‚",
            "è²“å’ªä¸æœƒå«Œé­šä¹¾å¤šï¼",
            "ä¸æƒ¹ç¡è¦ºçš„è²“ï¼",
            "å¤©ä¸Šçš„é£›é³¥ä¸ç‚ºåƒå–æ†‚æ…®ï¼Œè²“å’ªä¹Ÿä¸ç‚ºé­šä¹¾æ†‚æ„ã€‚",
            "å˜¿ï¼Œæœ€ä¹–å·§çš„è²“å’ªä¹Ÿæ›¾æ¨å€’æ¯å­ã€‚",
            "æ²’æœ‰ä»€éº¼æ˜¯ä¸€éš»è²“å’ªä¸èƒ½å…‹æœçš„ï¼Œå¦‚æœæœ‰ï¼Œé‚£å°±å‡ºå‹•å…©éš»è²“å’ªï¼",
            "ä¸‰éš»å¤§æ©˜è²“ï¼Œå‹éä¸€éš»ç·¬å› è²“ã€‚",
            "å¾æ—¥ä¸‰çœå–µèº«ï¼šè·Ÿè±¬è±¬èªªæ—©å®‰ä¹ï¼Ÿåƒé£½ä¹ï¼Ÿæ—©ç¡ä¹ï¼Ÿ",
            "æ­²å¯’ï¼Œç„¶å¾ŒçŸ¥è²“è²“ä¹‹èƒ–èƒ–ä¹Ÿã€‚",
            "ä¸ç¶“ä¸€ç•ªå¯’å¾¹éª¨ï¼Œæ€å¾—æ„Ÿå†’å‚·é¢¨å’³ã€‚ï¼ˆå’¦ï¼Ÿï¼‰",
            "ä¸–ä¸Šç„¡é›£äº‹ï¼Œæœ‰çš„è©±å°±ä¸åšäº†ï¼",
            "æ˜æ—¥å¾©æ˜æ—¥ï¼Œæ˜æ—¥ä½•å…¶å¤šï¼ä»Šå¤©å…ˆç¡è¦ºï¼Œè¬äº‹æ˜æ—¥ç£¨ã€‚",
            "é¢¨è²é›¨è²è®€æ›¸è²ï¼Œzzzzzzz",
            "é¾åºŠä¸å¦‚ç´™ç®±ã€‚",
            "å¾å‰æœ‰ä¸€éš»è²“èªªï¼šã€Œå–µ~ã€",
            "å°ä¸Šä¸€åˆ†é˜ï¼Œå°ä¸‹å…­åç§’ã€‚",
            "æ©˜è²“æœƒèˆ”å…‰æ¯å€‹ç½ç½ã€‚",
            "å¡ç¿å¤±é¦¬ï¼Œè·Ÿè²“å’ªæ²’æœ‰é—œä¿‚ã€‚",
            "ä¸»äººä¸åŠªåŠ›ï¼Œè²“è²“å¾’å‚·æ‚²ã€‚",
            "æœ‰æ™ºæ…§çš„è²“è²“ä¸è¿½æ±‚æŠŠæ‰‹æ‰‹æ”¾åœ¨ä¸Šå±¤ã€‚",
            "æ·±å¸ä¸€å£è²“ã€‚",
            "æˆåŠŸå±¬æ–¼é‚£äº›åŠªåŠ›ä¸æ‡ˆçš„è²“ï¼Œå› ç‚ºå®ƒå€‘ç¸½èƒ½è·³åˆ°è¢«ç¦æ­¢çš„æ¡Œå­ä¸Šã€‚",
            "ä¸è¦ç‚ºæ‰“ç¿»çš„ç‰›å¥¶å“­æ³£ï¼Œå› ç‚ºè²“å·²ç¶“åœ¨èˆ”äº†ã€‚",
            "äººç”Ÿè‹¦çŸ­ï¼ŒåŠæ™‚é¤Šè²“ã€‚",
            "æ„›ä¸€éš»è²“å°±è¦æ¥å—å®ƒåŠå¤œè¸©ä½ çš„è‡‰ã€‚",
            "ä¸è¦å’Œè²“çˆ­æ²™ç™¼ï¼Œå› ç‚ºä½ æœƒè¼¸ï¼Œè²“å»å¾ˆé–‹å¿ƒï¼",
            "ä¸Šå¤©é—œé–‰äº†ä¸€æ‰‡é–€ï¼Œè²“è²“æœƒå¹«ä½ æ‰“é–‹è¡£æ«ƒï¼",
            "æ™‚é–“æœƒæ²»ç™’ä¸€åˆ‡ï¼Œé™¤äº†è¢«è²“è²“æ¨å€’çš„æ±è¥¿ã€‚",
            "å¿ƒæœ‰å¤šå¤§ï¼Œè²“çš„é ˜åœ°å°±æœ‰å¤šå¤§ã€‚",
            "è²“å°±æ˜¯åœ¨ä½ è¶•æ–‡ä»¶æ™‚è·³ä¸Šéµç›¤çš„å‚¢ä¼™ã€‚",
            "éš”å£å®¶çš„ç½ç½å¥½åƒæ›´å¥½åƒï¼",
            "å·±æ‰€ä¸æ¬²ï¼Œè²“ç…§æ¨£æœƒåšçµ¦ä½ çœ‹ï¼",
            "è²“è²“æ‰€è¦‹ç•¥åŒ----æ‰€æœ‰ç®±å­éƒ½æ˜¯ç‰ å€‘çš„ã€‚",
            "ä¸€å€‹äººå¯ä»¥è¢«æ¯€æ»…ï¼Œä½†è²“ä¸æœƒå±ˆæœ----é™¤äº†è¨è¦ç½ç½çš„æ™‚å€™ã€‚",
            "æ©Ÿæœƒæ˜¯ç•™çµ¦â€¦â€¦è²“å¾ä¸æº–å‚™ï¼Œå®ƒæœƒç›´æ¥è·³ä¸Šå»ï¼",
            "çµ¦è²“ä¸€å€‹ç´™ç®±ï¼Œç‰ å¯ä»¥ç’°éŠä¸–ç•Œã€‚",
            "ä½ æœ€å¯æ„›muah /////",
            "è²“ç¡æˆä¸€å€‹å¯æ„›çš„å°æœˆäº®ï¼Œå¦‚æ­¤å®‰ç©©ã€‚",
            "å–µå–µå–µï¼Ÿå–µï¼"
        ];

        // åœ–ç‰‡å’Œåœ–ç‰‡URLè¨­å®š
        const INITIAL_IMAGE = "https://i.imgur.com/RdfIav1.png";
        const CLICKED_IMAGE = "https://i.imgur.com/Ff7QTIv.png";
        const FINAL_IMAGE = "https://i.imgur.com/dgyoDVN.jpeg";
        
        // å„²å­˜éµå
        const FORTUNE_STORAGE_KEY = 'dailyFortuneData';
        
        // åœ–ç‰‡é»æ“Šäº‹ä»¶
        let isAnimating = false;
        let clickCount = 0;
        const requiredClicks = 5;
        let canPredict = true; // æ˜¯å¦å¯ä»¥é€²è¡Œå åœ
        let lastPrediction = null; // æœ€å¾Œä¸€æ¬¡å åœçš„çµæœ
        let lastPredictionTime = null; // æœ€å¾Œä¸€æ¬¡å åœçš„æ™‚é–“
        
        // ç²å–ç•¶å‰æ™‚é–“åˆ°ä¸‹ä¸€å€‹æ—©ä¸Š7é»çš„æ¯«ç§’æ•¸
        function getTimeToNextReset() {
            const now = new Date();
            // æ˜å¤©æ—©ä¸Š7é»
            const tomorrow = new Date(now);
            tomorrow.setDate(now.getDate() + 1);
            tomorrow.setHours(7, 0, 0, 0);
            
            // å¦‚æœç¾åœ¨æ™‚é–“é‚„æ²’åˆ°ä»Šå¤©æ—©ä¸Š7é»ï¼Œé‚£éº¼é‡ç½®æ™‚é–“æ˜¯ä»Šå¤©æ—©ä¸Š7é»
            if (now.getHours() < 7) {
                tomorrow.setDate(now.getDate());
            }
            
            return tomorrow.getTime() - now.getTime();
        }
        
        // æ ¼å¼åŒ–å€’è¨ˆæ™‚æ™‚é–“ç‚º HH:MM:SS æ ¼å¼
        function formatCountdown(milliseconds) {
            // è½‰æ›æ¯«ç§’åˆ°å°æ™‚ã€åˆ†é˜å’Œç§’
            let totalSeconds = Math.floor(milliseconds / 1000);
            let hours = Math.floor(totalSeconds / 3600);
            let minutes = Math.floor((totalSeconds % 3600) / 60);
            let seconds = totalSeconds % 60;
            
            // è£œé›¶
            return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }
        
        // æ›´æ–°å€’è¨ˆæ™‚é¡¯ç¤º
        function updateCountdown() {
            const countdownContainer = document.getElementById('countdown-container');
            const countdownTimer = document.getElementById('countdown-timer');
            
            // å¦‚æœæ²¡æœ‰ä¸Šæ¬¡çš„å åœæ™‚é–“ï¼Œéš±è—å€’è¨ˆæ™‚
            if (!lastPredictionTime) {
                countdownContainer.classList.add('hidden');
                return;
            }
            
            const timeToNextReset = getTimeToNextReset();
            countdownTimer.textContent = formatCountdown(timeToNextReset);
            
            // å¦‚æœå€’è¨ˆæ™‚çµæŸï¼Œæ¢å¾©å åœåŠŸèƒ½
            if (timeToNextReset <= 0) {
                resetFortuneState();
            }
        }
        
        // è·å–åœ–ç‰‡å…ƒç´ 
        const initialImage = document.getElementById('initial-image');
        const clickedImage = document.getElementById('clicked-image');
        const finalImage = document.getElementById('final-image');
        const fortuneBox = document.getElementById('fortune-box');
        const fortuneText = document.getElementById('fortune-text');
        const loading = document.getElementById('loading');
        const clickProgress = document.getElementById('click-progress');
        const countdownContainer = document.getElementById('countdown-container');
        
        // é‡ç½®å åœç‹€æ…‹
        function resetFortuneState() {
            canPredict = true;
            lastPrediction = null;
            lastPredictionTime = null;
            clickCount = 0;
            
            // é‡ç½®UI
            showImage(initialImage);
            fortuneBox.classList.remove('show');
            countdownContainer.classList.add('hidden');
            clickProgress.textContent = `å†æŒ‰ ${requiredClicks} æ¬¡`;
            clickProgress.classList.add('show');
            
            // æ¸…é™¤æœ¬åœ°å„²å­˜
            try {
                localStorage.removeItem(FORTUNE_STORAGE_KEY);
            } catch (e) {
                // å¿½ç•¥éŒ¯èª¤
            }
        }
        
        // ä¿å­˜å åœçµæœåˆ°æœ¬åœ°å„²å­˜
        function saveFortuneState(prediction) {
            const now = new Date();
            lastPrediction = prediction;
            lastPredictionTime = now.getTime();
            
            try {
                // ä½¿ç”¨ sessionStorage ä»£æ›¿ localStorageï¼Œè¿™æ ·åœ¨é¡µé¢åˆ·æ–°åä»å¯ç”¨ï¼Œä½†åœ¨æµè§ˆå™¨å…³é—­åä¼šæ¸…é™¤
                sessionStorage.setItem(FORTUNE_STORAGE_KEY, JSON.stringify({
                    prediction: lastPrediction,
                    time: lastPredictionTime
                }));
                
                // å°è¯•ä½¿ç”¨localStorageä½œä¸ºå¤‡ä»½
                try {
                    localStorage.setItem(FORTUNE_STORAGE_KEY, JSON.stringify({
                        prediction: lastPrediction,
                        time: lastPredictionTime
                    }));
                } catch (storageErr) {
                    console.log('localStorageä¿å­˜å¤±è´¥ï¼Œä½†å·²ä¿å­˜åˆ°sessionStorage:', storageErr);
                }
                
                // ç¢ºä¿åœ¨å­˜å„²å åœçµæœå¾Œå†å¢åŠ ç°½åˆ°æ¬¡æ•¸ï¼Œä½†åƒ…åœ¨ä»Šæ—¥æœªç°½åˆ°çš„æƒ…æ³ä¸‹
                setTimeout(() => {
                    // æª¢æŸ¥æ¯æ—¥ç°½åˆ°ä¸Šé™
                    if (!hasCheckedInToday()) {
                        // å¢åŠ ç°½åˆ°æ¬¡æ•¸
                        incrementCheckinCount();
                        
                        // ä¿å­˜ä»Šå¤©å·²ç°½åˆ°çš„ç´€éŒ„
                        try {
                            localStorage.setItem(LAST_CHECKIN_DATE_KEY, now.getTime().toString());
                        } catch (e) {
                            sessionStorage.setItem(LAST_CHECKIN_DATE_KEY, now.getTime().toString());
                        }
                    }
                }, 100);
            } catch (e) {
                console.log('ä¿å­˜å åœçµæœå¤±æ•—:', e);
            }
            
            // æ›´æ–°UI
            canPredict = false;
            fortuneText.textContent = lastPrediction;
            fortuneBox.classList.add('show');
            countdownContainer.classList.remove('hidden');
            clickProgress.classList.remove('show');
        }
        
        // å‰µå»ºå†…å­˜è®Šé‡å­˜å„²ç‹€æ…‹ - ä¸ä½¿ç”¨localStorage
        let memoryStorage = {};
        
        // è¼‰å…¥å åœç‹€æ…‹ - ä½¿ç”¨å†…å­˜å˜é‡è€ŒélocalStorage
        function loadFortuneState() {
            try {
                let savedData = memoryStorage[FORTUNE_STORAGE_KEY];
                
                if (savedData) {
                    const { prediction, time } = savedData;
                    const savedTime = new Date(time);
                    const now = new Date();
                    
                    // æª¢æŸ¥æ˜¯å¦æ˜¯åŒä¸€å€‹"é‡ç½®å‘¨æœŸ"
                    // è¨ˆç®—æœ€å¾Œä¸€æ¬¡å åœæ™‚é–“åˆ°ç•¶å‰çš„æœ€è¿‘ä¸€å€‹7é»æ˜¯å¦å·²ç¶“éå»
                    let resetTime = new Date(savedTime);
                    // å¦‚æœå åœæ™‚é–“æ˜¯åœ¨7é»ä¹‹å‰ï¼Œé‚£éº¼é‡ç½®æ™‚é–“æ˜¯ç•¶å¤©æ—©ä¸Š7é»
                    if (savedTime.getHours() < 7) {
                        resetTime.setHours(7, 0, 0, 0);
                    } 
                    // å¦å‰‡é‡ç½®æ™‚é–“æ˜¯éš”å¤©æ—©ä¸Š7é»
                    else {
                        resetTime.setDate(resetTime.getDate() + 1);
                        resetTime.setHours(7, 0, 0, 0);
                    }
                    
                    // å¦‚æœç¾åœ¨æ™‚é–“é‚„æ²’åˆ°é‡ç½®æ™‚é–“ï¼Œæ¢å¾©ä¸Šæ¬¡å åœç‹€æ…‹
                    if (now < resetTime) {
                        lastPrediction = prediction;
                        lastPredictionTime = time;
                        canPredict = false;
                        
                        // æ›´æ–°UI
                        showImage(finalImage);
                        fortuneText.textContent = lastPrediction;
                        fortuneBox.classList.add('show');
                        countdownContainer.classList.remove('hidden');
                        clickProgress.classList.remove('show');
                    } else {
                        // å·²éé‡ç½®æ™‚é–“ï¼Œé‡ç½®ç‹€æ…‹
                        resetFortuneState();
                    }
                }
            } catch (e) {
                console.error('è¼‰å…¥å åœç‹€æ…‹å¤±æ•—:', e);
                // å‡ºéŒ¯æ™‚é‡ç½®
                resetFortuneState();
            }
        }
        
        // é åŠ è¼‰åœ–ç‰‡ä»¥ç¢ºä¿å¹³æ»‘éæ¸¡
        function preloadImages() {
            const images = [
                "https://i.imgur.com/RdfIav1.png",
                "https://i.imgur.com/Ff7QTIv.png",
                "https://i.imgur.com/dgyoDVN.jpeg"
            ];
            
            images.forEach(src => {
                const img = new Image();
                img.src = src;
            });
        }
        
        // åˆ‡æ›æ´»å‹•åœ–ç‰‡
        function showImage(imageToShow) {
            // éš±è—æ‰€æœ‰åœ–ç‰‡
            initialImage.classList.remove('image-active');
            clickedImage.classList.remove('image-active');
            finalImage.classList.remove('image-active');
            
            // é¡¯ç¤ºæŒ‡å®šçš„åœ–ç‰‡
            imageToShow.classList.add('image-active');
        }
        
        // åˆå§‹åŒ–éƒµç®±ç®±åŠŸèƒ½
        function initMailbox() {
            const mailbox = document.getElementById('mailbox');
            const mailModal = document.getElementById('mail-modal');
            const closeBtn = mailModal.querySelector('.modal-close');
            const mailItems = mailModal.querySelectorAll('.mail-item');
            const mailListView = document.getElementById('mail-list-view');
            const mailDetailView = document.getElementById('mail-detail-view');
            const backToListBtn = document.getElementById('back-to-list');
            const mailDetailTitle = document.getElementById('mail-detail-title');
            const mailDetailContent = document.getElementById('mail-detail-content');
            const mailContentsContainer = document.getElementById('mail-contents');
            
            // æ‰“é–‹éƒµç®±ç®± - æ¯æ¬¡æ‰“é–‹éƒ½é¡¯ç¤ºåˆ—è¡¨è¦–åœ–
            mailbox.addEventListener('click', () => {
                // é‡ç½®è¦–åœ–
                mailListView.classList.remove('hidden');
                mailDetailView.classList.add('hidden');
                
                // é¡¯ç¤ºæ¨¡æ…‹çª—å£
                mailModal.classList.add('active');
            });
            
            // é—œé–‰éƒµç®±ç®±
            closeBtn.addEventListener('click', () => {
                mailModal.classList.remove('active');
                
                // å»¶é²å¾Œé‡ç½®è¦–åœ–ï¼Œä»¥ä¾¿ä¸‹æ¬¡æ‰“é–‹é¡¯ç¤ºåˆ—è¡¨
                setTimeout(() => {
                    mailListView.classList.remove('hidden');
                    mailDetailView.classList.add('hidden');
                }, 300);
            });
            
            // é»æ“Šéƒµç®±åˆ—è¡¨é …ç›®
            mailItems.forEach(item => {
                item.addEventListener('click', () => {
                    // ç²å–éƒµç®±æ•¸æ“š
                    const mailId = item.getAttribute('data-mail-id');
                    const mailContentElement = mailContentsContainer.querySelector(`#${mailId}`);
                    const mailContent = mailContentElement ? mailContentElement.textContent : 'ç„¡å…§å®¹';
                    
                    // å¡«å……éƒµç®±è©³æƒ…è¦–åœ–
                    mailDetailContent.textContent = mailContent;
                    
                    // é¡¯ç¤ºè©³æƒ…è¦–åœ–ï¼Œéš±è—åˆ—è¡¨è¦–åœ–
                    mailListView.classList.add('hidden');
                    mailDetailView.classList.remove('hidden');
                });
            });
            
            // è¿”å›æŒ‰éˆ•é»æ“Šäº‹ä»¶
            backToListBtn.addEventListener('click', () => {
                // é¡¯ç¤ºåˆ—è¡¨è¦–åœ–ï¼Œéš±è—è©³æƒ…è¦–åœ–
                mailListView.classList.remove('hidden');
                mailDetailView.classList.add('hidden');
            });
            
            // é»æ“Šæ¨¡æ…‹çª—å£èƒŒæ™¯é—œé–‰çª—å£
            mailModal.addEventListener('click', (e) => {
                if (e.target === mailModal) {
                    mailModal.classList.remove('active');
                    
                    // å»¶é²å¾Œé‡ç½®è¦–åœ–
                    setTimeout(() => {
                        mailListView.classList.remove('hidden');
                        mailDetailView.classList.add('hidden');
                    }, 300);
                }
            });
            
            // æ·»åŠ ESCéµé—œé–‰åŠŸèƒ½
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && mailModal.classList.contains('active')) {
                    mailModal.classList.remove('active');
                    
                    // å»¶é²å¾Œé‡ç½®è¦–åœ–
                    setTimeout(() => {
                        mailListView.classList.remove('hidden');
                        mailDetailView.classList.add('hidden');
                    }, 300);
                }
            });
        }
        
        // åˆå§‹åŒ–
        function init() {
            // è¼‰å…¥ä¿å­˜çš„ç‹€æ…‹
            loadFortuneState();
            
            // è¼‰å…¥æ‰“å¡è¨ˆæ•¸
            loadCheckinCount();
            
            // æ›´æ–°ç­¾åˆ°æŒ‰é’®çŠ¶æ€
            updateCheckinButtonState();
            
            // å¦‚æœå¯ä»¥å åœï¼Œé¡¯ç¤ºé»æ“Šæç¤º
            if (canPredict) {
                clickProgress.textContent = `å†æŒ‰ ${requiredClicks} æ¬¡`;
                clickProgress.classList.add('show');
            }
            
            // é åŠ è¼‰åœ–ç‰‡
            preloadImages();
            
            // è¨­ç½®å€’è¨ˆæ™‚å®šæ™‚å™¨
            setInterval(updateCountdown, 1000);
            
            // è®¾ç½®ç­¾åˆ°å€’è®¡æ—¶å®šæ—¶å™¨
            setInterval(updateCheckinCountdown, 1000);
            
            // åˆå§‹åŒ–éƒµç®±ç®±åŠŸèƒ½
            initMailbox();
            
            // ç°½åˆ°æŒ‰éˆ•é»æ“Šäº‹ä»¶
            const checkinCounter = document.getElementById('checkin-counter');
            checkinCounter.addEventListener('click', function() {
                incrementCheckinCount();
            });
        }
        
        // é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–
        init();
        
        // åœ–ç‰‡é»æ“Šäº‹ä»¶
        document.getElementById('image-container').addEventListener('click', async function() {
            // å¦‚æœä¸èƒ½å åœæˆ–åŠ¨ç•«æ­£åœ¨é€²è¡Œï¼Œè¿”å›
            if (!canPredict || isAnimating) return;
            
            // æ›´æ–°é»æ“Šè¨ˆæ•¸
            clickCount++;
            
            // åˆ‡æ›åˆ°é»æ“Šåœ–ç‰‡
            showImage(clickedImage);
            
            // å°‡åœ–ç‰‡åŒ…è£å™¨æ·»åŠ æ–å‹•å‹•ç•«
            const imageWrapper = document.querySelector('.image-wrapper');
            imageWrapper.classList.add('shake');
            
            // ç§»é™¤æ–å‹•å‹•ç•«
            setTimeout(() => {
                imageWrapper.classList.remove('shake');
            }, 500);
            
            // 0.5ç§’å¾Œæ¢å¾©åŸåœ–ç‰‡ï¼ˆå¦‚æœé‚„æ²’é”åˆ°5æ¬¡é»æ“Šï¼‰
            setTimeout(() => {
                // å¦‚æœé‚„æ²’æœ‰å®Œæˆæ‰€æœ‰é»æ“Šæˆ–è€…æ­£åœ¨é€²è¡Œå åœï¼Œæ¢å¾©åŸä¾†çš„åœ–ç‰‡
                if (clickCount < requiredClicks && !isAnimating) {
                    showImage(initialImage);
                }
            }, 500);
            
            // æª¢æŸ¥æ˜¯å¦é”åˆ°æ‰€éœ€é»æ“Šæ¬¡æ•¸
            if (clickCount < requiredClicks) {
                // æ›´æ–°æç¤ºæ–‡å­—
                clickProgress.textContent = `å†æŒ‰ ${requiredClicks - clickCount} æ¬¡`;
                return;
            }
            
            // é”åˆ°æ‰€éœ€é»æ“Šæ¬¡æ•¸ï¼ŒåŸ·è¡Œå åœ
            isAnimating = true;
            
            // éš±è—é»æ“Šæç¤º
            clickProgress.classList.remove('show');
            
            // åˆ‡æ›åˆ°æœ€çµ‚åœ–ç‰‡
            showImage(finalImage);
            
            // éš±è—ä¸Šä¸€æ¬¡çš„çµæœ
            fortuneBox.classList.remove('show');
            
            // é¡¯ç¤ºåŠ è¼‰å‹•ç•«
            loading.style.display = 'block';
            
            // éš¨æ©Ÿé¸æ“‡ä¸€å€‹é¼“å‹µå¥å­
            const randomIndex = Math.floor(Math.random() * encouragements.length);
            const selectedEncouragement = encouragements[randomIndex];
            
            // æ¨¡æ“¬æ€è€ƒæ™‚é–“
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            // éš±è—åŠ è¼‰å‹•ç•«
            loading.style.display = 'none';
            
            // ä¿å­˜ä¸¦é¡¯ç¤ºå åœçµæœ
            saveFortuneState(selectedEncouragement);
            
            // è¨­ç½®å‹•ç•«çµæŸ
            isAnimating = false;
        });
    </script>


</body></html>

